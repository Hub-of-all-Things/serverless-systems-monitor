language: scala
dist: trusty
sudo: false
scala:
  - 2.12.4
jdk:
  - openjdk8

branches:
  only:
    - master
    - dev

env:
  global:
    - AWS_DEFAULT_REGION=eu-west-1
    - secure: "MQ7z1QJMYrj5BvE6zENtZQd4DYus/zMMjWkcyEscRzP8AU8u/OJ1MlRn0bfMcU0GXzLIWxTr+5zGGPa3ujeFNfK8HfSMpew4iLkurSnnL/nVxE2JdkVYjyJ28tJUgn2TemsUm29DJeAKDWoEIXesncOm+L6mvNf1k9t38Ks98slz+DQHjQrZbtnexsnKeaZoRPww7s8S9oNHO21cicygAZxW8yJWyc17VnOAcw93YDZT95HQy8o0jzvK3F8gePvPleWnZBl/77aJXS95fgEGXAvkzykOyUgdDcPdzOpBf/4cbDTXW/I/hXHkU7uYIRdJbE7DjNBouvYoPK36sdrOI/za186EL6J4Xx0XmRN55CzavFgGz0VoqWRNBPcKN2BiYL+mhyRRmpqSt38hpdMy0B6LpM7VMfz13peY3/u1oqRLIDe3ai9Spa2ZUs5WZidmhEqdaHXH1L5PXG1iJrRir0cnHA0L1QllveB5uZCPgdA1jz1PLWyyLH6lUR3ZEJyHX3zlbYdX57hSkZX2hcvPi9htfz2Y/ebwWP+jv1qMFir98VHDV1fEZWP2jaLh+djqy/Kb0WbtJHXu/Qidw/biKULayVMSJqGgRvRcNHrt6+fAWbweUb91eMFxnu9hcFzAWo9P5fH5OrzTFp0Y4vObYeY/Bx9+yPBXmfn3ALrTaio="
    - secure: "FF36oz2pvy/7lLpsGnzBBuhgtFKluEvw+2i/Q0koygdOZBnwST0vClEeFfyLW0HdQFWSYUao2nePnlv+dR+FwYLmYgwupXWYfmCcLwPCyCQYIJwUcFwdFqwg3dlSFDWyqgj7fClfJCFzwKGfvNOLqEmNtyVXDk7gnb72ZYbOoY/3mQL+Y60CEmJIfW4xV0InjUQoE5KtNe+TxuHRKrfNbWEuu470mU9EVijQVa8Y/Rt7pQHPrfY/LQt8dODJMscbrGAawqWRo+58w8DGg/CoBFc/x7AvU61D3Pk2gdM8N9bt6s0w6lzcAGZoluskmXHqC9q0gtl9M74ml63kpHE8S/T2dRDk7mWCaW6ECfWLwJOOVPTB2gkTRxocBV5OuxGRG+jTvyCkc7HvA2+N8G4AEKBic5qB6aiA6pdWcTiscqzNZt7y7oGT1CgCW+7xkiOY+BbGE7Lj4qCaeRes+85Jn44SvYijh+hwapSvLVMCHJEVzkAmm4WtXbYem9VmPhfU1fQG3ePjgzgH9AVVT590E/z4GU5wUflNrlb3A1Wuy0E6TuHdB7tMHak0qmsq+1LHzNgQGPKMoazkG6MZ3OEO/tsw7GO7LfTeCfopR8YXR3F8XwLfkWJh5KPS2oQtIuHvneJMY8JxZLXK2CEkQNiKCByW+vR+Fad82hdR1/p+hAM="

before_install:
  - nvm install 6.10

install:
  - npm install -g serverless

script:
  - mkdir artifacts
  - cd status-monitor
  - sbt assembly
  - cd -
  - cp status-monitor/target/scala-2.12/status-monitor.jar artifacts/status-monitor.jar
  - cd newman
  - npm install
  - zip -qur ../artifacts/newman.zip handler.js package.json node_modules/
  - cd -

deploy:
  - provider: script
    script:
      - serverless deploy
    skip_cleanup: true
